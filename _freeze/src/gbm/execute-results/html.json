{
  "hash": "8a7d008ddb500915b4d037a1578cb198",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"幾何ブラウン運動\"\nformat: html\n---\n\n幾何ブラウン運動は、対数 $\\ln S_t$ がドリフト付きブラウン運動に従う連続時間の確率過程である。\n\nブラック・ショールズ・モデルにおける危険資産の価格過程のモデル化に用いられるのが一般的だが、価格が負の値をとらない（非負性）という性質を持つため、Vasicek モデル等で課題となる「負の金利」を回避する目的で、瞬間金利のモデルとして用いられることもある。\n\nGBM モデルでは、資産価格 $S_t$ を以下の確率微分方程式で記述する。\n\n$$\ndS_t = \\mu S_t dt + \\sigma S_t dW_t\n$$\n\nここで、$\\mu$ は期待収益率（ドリフト）、$\\sigma$ はボラティリティ、$W_t$ は標準ウィーナー過程を表す。\nこの式は、微小時間における価格の変化量 $dS_t$ が、その時の価格水準 $S_t$ に比例することを意味している。\n\n関数 $f(S_t) = \\ln S_t$ に対して伊藤の公式を適用することで、幾何ブラウン運動モデルに従う資産価格の対数価格 $\\ln S_t$ に関する次の式を得る。\n\n$$\nd(\\ln S_t) = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) dt + \\sigma dW_t\n$$\n\nこの変換で得られた式はドリフト付きのウィーナー過程である。\n\n初期値を $S_0$ とするとき、解は次のように表せる。\n\n$$\nS_t = S_0 \\exp \\left( \\left( \\mu-\\frac{1}{2} \\sigma^2 \\right)t+\\sigma W_t \\right)\n$$\n\n対数価格に関する確率微分方程式を時間刻み $\\Delta t$ で離散化することで、以下の時系列モデルを得る。\n\n$$\n\\ln S_{t+\\Delta t}-\\ln S_t=\\ln \\left( \\frac{S_{t+\\Delta t}}{S_t} \\right) = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\Delta t + \\sigma \\sqrt{\\Delta t}\\; \\epsilon_t\n$$\n\nこのモデルでは、各微小時間の対数収益率は、それぞれ一定の平均と分散を持つ独立な正規分布に従う。\nつまり、離散化された GBM モデルは、対数価格に対して定数項付きの単位根過程を仮定することに他ならない。\n\n::: panel-tabset\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\ntheme_set(theme_bw())\n\nset.seed(42)\n\nyears <- 10\nN <- 252 * years\ndt <- years / N\ntime <- seq(0, years, by = dt)\n\nS0 <- 100\nmu <- 0.05\nsigma <- 0.2\nm <- 100\n\ndf <- list()\nfor (i in seq_len(m)) {\n  drift <- (mu - sigma ** 2 / 2) * dt\n  diffusion <- sigma * sqrt(dt) * rnorm(N)\n  dlnS <- drift + diffusion\n  path <- S0 * exp(cumsum(c(0, dlnS)))\n  df[[length(df) + 1]] <-\n    data.frame(id = i, time = time, path = path)\n}\ndf <- do.call(rbind, df)\n\nggplot(df, aes(x = time, y = path, group = id, alpha = id)) +\n  geom_line() +\n  scale_color_continuous() +\n  labs(title = \"Discretized Geometric Brownian Motion\",\n       x = \"Time (Years)\", y = \"Price\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](gbm_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n:::\n\n価格過程 $S_t$ が幾何ブラウン運動でモデル化される場合、各時点における対数価格が正規分布に従うことから、元の価格は対数正規分布に従う。\nそのことは、数値シミュレーションの結果からも以下のように確認できる。\n\n::: panel-tabset\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsnapshots <- df$time[N %/% 1:6]\ndf_snapshots <- df[df$time %in% snapshots, ]\nggplot() +\n  geom_density(\n    aes(path, group = time, fill = time),\n    data = df_snapshots,\n    alpha = 0.5,\n    ) +\n  lims(x = c(0, NA)) +\n  labs(subtitle = \"Realized Distribution of the Price\",\n       x = \"Price\", y = \"Density\")\n```\n\n::: {.cell-output-display}\n![](gbm_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n:::\n",
    "supporting": [
      "gbm_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}