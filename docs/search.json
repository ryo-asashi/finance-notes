[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Finance-Notes: Time Series and SDE",
    "section": "",
    "text": "This repository explores time-series and SDE models for finance, with a focus on their relationships and implementation in both R and Python.\nこのリポジトリは、ファイナンスにおける時系列モデルと確率微分方程式（SDE）モデルの両方について、その関係に注目しながら整理することを目的とした（数学を得意としない著者による）個人的な学習ノートです。",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>はじめに</span>"
    ]
  },
  {
    "objectID": "src/interest.html",
    "href": "src/interest.html",
    "title": "金利",
    "section": "",
    "text": "満期 \\(T\\) に額面 \\(1\\) を償還する割引債の時点 \\(t\\) における価格を \\(v(t, T)\\) で表し、その連続複利ベース最終利回り（スポットレート）を \\(\\delta(t, T)\\) とする。 スポットレートについて次の式が成立する。\n\\[\nv(t,T)=e^{-\\delta(t,T)(T-t)}\n\\]\nこれを \\(\\delta(t,T)\\) について解くことで次の式を得る。\n\\[\n\\delta(t,T)=-\\frac{\\ln v(t,T)}{T-t}\n\\]\n特に、信用リスクのない割引債の価格 \\(v(t,T)\\) は将来価値を現在価値に換算するための割引率として用いられる。\nまた、\\(Y_t(u)=\\delta(t,t+u)\\) を時点 \\(t\\) における（連続複利ベースの）イールドカーブと呼ぶ。 イールドカーブはその時点における金利の期間構造を表している。\n満期までの時間 \\(h=T-t\\) を \\(0\\) に近づけるときの極限 \\(r(t)\\) を瞬間金利（瞬間スポットレート）という。\n\\[\nr(t)=\\lim_{h\\to 0}\\delta(t,t+h)\n=-\\lim_{h\\to 0}\\frac{\\ln v(t,t+h)}{h}\n=-\\frac{\\partial \\ln v(t,u)}{\\partial u}\\Bigg{|}_{u=t}\n\\]\n時点 \\(t\\) よりも後の時点 \\(u\\) から満期 \\(T\\) まで割引債を保有することで得られる連続複利ベース利回り \\(\\delta_f(t,u,T)\\) をフォワードレートと呼ぶ。 フォワードレートについて次の式が成立する。\n\\[\nv(t,T)= v(t,u)\\;e^{-\\delta_f(t,u,T)(T-u)}\n\\]\nこの式を \\(\\delta_f\\) について解くことによって次の式を得る。\n\\[\n\\begin{align}\n\\\\ \\delta_f(t,u,T)&=-\\frac{\\ln v(t,T)-\\ln v(t,u)}{T-u}\n\\\\ &=\\frac{\\delta(t,T)(T-t)-\\delta(t,u)(u-t)}{T-u}\n\\end{align}\n\\]\nまた、将来時点から満期までの時間 \\(h=T-u\\) を \\(0\\) に近づけるときの極限 \\(f(t, u)\\) を瞬間フォワードレートと呼ぶ。\n\\[\nf(t,u) = \\lim_{h \\to 0} \\delta_f(t,u,u+h)\n= -\\frac{\\partial \\ln v(t,u)}{\\partial u}\n\\]\n瞬間フォワードレートは時点 \\(t\\) において予約された将来時点 \\(u\\) における「瞬間の利力」であり、これを用いると、割引債価格は \\(v(t, T) = \\exp \\left( -\\int_t^T f(t, s) ds \\right)\\) と表せる。\nまた、瞬間金利と瞬間フォワードレートの間には \\(f(t,t)=r(t)\\) という関係が成り立つ。\n期中にクーポンの支払いがある債券を利付債と呼び、特にクーポンが時点によらず一定であるものを固定利付債という。 時点 \\(t_1,t_2,\\dots,t_n\\) にクーポン \\(C_1,C_2,\\dots,C_n\\) を支払い、満期 \\(T=t_n\\) に額面 \\(1\\) を償還する割引債の時点 \\(t\\) における価格 \\(v_C(t, T)\\) は以下のように書ける。\n\\[\nv_C(t,T)=\\sum_{i=1}^{n-1} v(t,t_i)\\;C_i + v(t,T)\\;(1+C_n)\n\\]",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>金利</span>"
    ]
  },
  {
    "objectID": "src/returns.html",
    "href": "src/returns.html",
    "title": "収益率",
    "section": "",
    "text": "価格過程 \\(\\{S_t\\}_{0\\le t}\\) について、時点 \\(t\\) から \\(t+\\Delta t\\) までの微小時間における算術収益率 \\(R_a=R_a(t,t+\\Delta t)\\) と対数収益率 \\(R_\\ell=R_\\ell(t,t+\\Delta t)\\) を以下のように定義する。\n\\[\n\\begin{aligned}\nR_a &= \\frac{S_{t+\\Delta t}-S_t}{S_t}\n\\\\\nR_\\ell &= \\ln\\left(\\frac{S_{t+\\Delta t}}{S_t}\\right)\n\\end{aligned}\n\\]\nこのとき次が成立する。\n\\[\n\\begin{aligned}\nS_{t+\\Delta t}&=S_t\\;(1+R_a)\n\\\\\n&={S_t}\\;\\exp{(R_\\ell)}\n\\\\\\\\\nR_\\ell&=\\ln{(1+R_a)}\n\\end{aligned}\n\\]\nここで、\\(R_a = 0\\) の近傍では \\(R_\\ell=\\ln (1+R_a) \\approx R_a\\) であるから、価格の変化が十分小さければ算術収益率と対数収益率は互いに近い値をとる。\n\n\n\n\n\n\n\n\n\n対数収益率は時間方向の加法性を持つため、累積収益率の算出や多期間の統計分析において計算効率に優れている。 一方、算術収益率は資産間の加重平均がポートフォリオの収益率に一致するという資産方向の加法性を持つため、アセット・アロケーションの実務に適している。\nある証券の価格過程 \\(S_t\\) が次の幾何ブラウン運動で表されるとする。\n\\[\n\\frac{dS_t}{S_t} = \\mu dt + \\sigma dW_t\n\\]\nこの確率微分方程式をそのままオイラー-丸山法で離散化すると以下のようになる。\n\\[\n\\frac{S_{t+\\Delta t} - S_t}{S_t} \\approx \\mu \\Delta t + \\sigma \\sqrt{\\Delta t}\\; \\epsilon_t\n\\]\n左辺は微小時間における算術収益率で、ドリフトは \\(\\mu\\) である。 ただし、この形式による離散化は \\(S_t\\) の非負性を保証せず、また、\\(\\Delta t\\) の大きさに応じた離散化誤差を生じることに注意が必要である。\n一方、幾何ブラウン運動において \\(f(S_t) = \\ln S_t\\) として伊藤の公式を適用することで、対数価格に関する次の式を得る。\n\\[\nd(\\ln S_t) = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) dt + \\sigma dW_t\n\\]\nこれを離散化した以下の式は、幾何ブラウン運動の厳密な解に対応する。\n\\[\n\\ln\\left(\\frac{S_{t+\\Delta t}}{S_t}\\right) \\approx \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\Delta t + \\sigma \\sqrt{\\Delta t}\\;\\epsilon_t\n\\]\n対数収益率のドリフトは \\(\\mu - \\frac{1}{2}\\sigma^2\\) となり、算術収益率のドリフト \\(\\mu\\) からボラティリティの半分が差し引かれることがわかる。 つまり、実際に得られる連続複利ベースの累積収益率は、算術収益率の期待値を下回る。 この目減り分 \\(1/2\\sigma^2\\) はボラティリティタックスと呼ばれ、資産運用の長期的なパフォーマンスを規定する重要な要素となる。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>収益率</span>"
    ]
  },
  {
    "objectID": "src/euler-maruyama.html",
    "href": "src/euler-maruyama.html",
    "title": "確率微分方程式の離散化",
    "section": "",
    "text": "以下の形式の伊藤過程を考える。\n\\[\nX_t = X_0 + \\int_0^t \\mu_s\\ ds + \\int_0^t \\sigma_s\\ dW_s\n\\]\nこれを微分形式で記述すると、以下の確率微分方程式（SDE）となる。\n\\[\ndX_t = \\mu_t\\ dt + \\sigma_t\\ dW_t\n\\]\n伊藤過程の見本路はどんな精度で拡大しても細かく振幅しているはずのものであり、そのまま描画することはできない。そこで、時間 \\([0, T]\\) を \\(N\\) 等分して離散化することを考える。時間の刻み幅は \\(\\Delta t\\) と表記する。\n\\[\n\\Delta t = T / N\n\\]\nオイラー・丸山法（Euler-Maruyama approximation）では、伊藤過程を以下のように近似する。 ここで、\\(\\{\\epsilon_t\\}_t\\) は標準正規分布 \\(N(0, 1)\\) に従う互いに独立な確率変数である。\n\\[\n\\hat{X}_{t+\\Delta t} = \\hat{X}_t + \\mu_t \\Delta t + \\sigma_t \\sqrt{\\Delta t} \\epsilon_t\n\\]\nこの近似は、ウィーナー過程の増分 \\(dW_t = W_{t+\\Delta t} - W_t\\) が正規分布 \\(N(0, \\Delta t)\\) に従うという性質に基づいている。この増分の分散は \\(\\Delta t\\) であるから、標準正規分布に乗じる係数を \\(\\sqrt{\\Delta t}\\) とすべき点に注意する。\nウィーナー過程 \\(W_t\\) 自体は、伊藤過程においてドリフト項 \\(\\mu_t = 0\\)、拡散項 \\(\\sigma_t = 1\\) とした最も基本的なケースである。この過程のオイラー・丸山法による離散近似は以下のように表現できる。\n\\[\n\\hat{W}_{t+\\Delta t} = \\hat{W}_t + \\sqrt{\\Delta t} \\epsilon_t\n\\]\nこの過程は時系列分析におけるランダムウォークにほかならない。\n以下では、ウィーナー過程を離散化することで得られたランダムウォークの見本路を作成してプロットする。\n\nRPython\n\n\n\nlibrary(ggplot2)\ntheme_set(theme_bw())\n\nset.seed(42)\n\nN &lt;- 252\ndt &lt;- 1 / N\ntime &lt;- seq(0, 1, by = dt)\n\n# 標準正規乱数の生成と累積和の計算\ndf &lt;- list()\nfor (i in 1:25) {\n  dW &lt;- sqrt(dt) * rnorm(N)\n  path &lt;- cumsum(c(0, dW))\n  df[[length(df) + 1]] &lt;-\n    data.frame(id = i, time=time, path=path)\n}\ndf &lt;- do.call(rbind, df)\n\n# プロット\nggplot(df) +\n  geom_line(aes(time, path, group=id)) +\n  labs(\n    title = \"Discretized Wiener Process\",\n    x = \"Time (t)\", y = \"W(t)\"\n  )\n\n\n\n\nウィーナー過程のシミュレーション（R）\n\n\n\n\n\n\n\nimport numpy as np\nimport pandas as pd\nfrom plotnine import *\ntheme_set(theme_bw())\n\nnp.random.seed(42)\n\nN = 252\ndt = 1 / N\ntime = np.linspace(0, 1, N + 1)\n\n# 標準正規乱数の生成と累積和の計算\ndf = list()\nfor i in range(25):\n  dW = np.sqrt(dt) * np.random.normal(0, 1, N)\n  path = np.cumsum(np.insert(dW, 0, 0))\n  df.append(\n    pd.DataFrame({'id':i, 'time':time, 'path':path})\n  )\ndf = pd.concat(df)\n\n# プロット\nggplot(df) + \\\n  geom_line(aes(\"time\", \"path\", group=\"id\")) + \\\n  labs(\n    subtitle = \"Discretized Wiener Process\",\n    x = \"Time (t)\", y = \"W(t)\"\n  )\n\n\n\n\nウィーナー過程のシミュレーション（Python）",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率微分方程式の離散化</span>"
    ]
  },
  {
    "objectID": "src/vasicek.html",
    "href": "src/vasicek.html",
    "title": "Vasicekモデル",
    "section": "",
    "text": "Vasicek モデルは、金利が長期的にみれば一定の水準 \\(\\theta\\) に引き戻されるという平均回帰性 (Mean Reversion) を取り入れた瞬間金利のモデルである。\n確率微分方程式は以下で与えられる。\n\\[\ndr_t = \\kappa\\;(\\theta - r_t)\\;dt + \\sigma\\;dW_t\n\\]\nただし、\\(\\kappa\\) は長期平均金利への平均回帰速度、\\(\\theta\\) は長期平均金利の水準、\\(\\sigma\\) はボラティリティ、 \\(dW_t\\) はウィーナー過程である。\nシミュレーションのために、オイラー・丸山法を用いて離散化すると以下のようになる。\n\\[\nr_{t+\\Delta t} = r_t + \\kappa\\;(\\theta - r_t)\\;\\Delta t + \\sigma\\;\\sqrt{\\Delta t}\\;\\epsilon_t\n\\]\nこれを以下のように整理すると、Vasicekモデルを離散化したものは1次の自己回帰モデル AR(1) になることがわかる。\n\\[\nr_{t+\\Delta t} = \\kappa\\theta\\Delta t + (1 - \\kappa\\Delta t)\\;r_t + \\sigma\\;\\sqrt{\\Delta t}\\;\\epsilon_t\n\\] これが定常過程であるための条件は \\(|1-\\kappa\\Delta t|&lt;1\\) であり、その時の期待値は \\(\\theta\\) となる。\n以下は、初期金利を \\(r_0 = 1\\%\\)、ボラティリティを \\(\\sigma=2\\%\\)、長期平均金利を \\(\\theta=5\\%\\)、平均回帰速度を \\(\\kappa=0.5\\) に設定した場合のシミュレーション例である。時間の経過とともに瞬間短期金利が \\(5\\%\\) に近づいていく様子が確認できる。\n\nRPython\n\n\n\nlibrary(ggplot2)\ntheme_set(theme_bw())\n\nset.seed(42)\n\nyears &lt;- 10\nN &lt;- 100 * years\ndt &lt;- years / N\ntime &lt;- seq(0, years, by = dt)\n\nr0 &lt;- 0.01\nsigma &lt;- 0.02\ntheta &lt;- 0.05\nkappa &lt;- 0.5\nm &lt;- 25\n\n# オイラー・丸山法によるシミュレーション\nrt &lt;- rep(r0, m)\ndf &lt;- list()\ndf[[1]] &lt;- data.frame(id = 1:m, time=time[1], rate=rt)\nfor (i in seq_len(N)) {\n  drift &lt;- kappa * (theta - rt) * dt\n  diffusion &lt;- sigma * sqrt(dt) * rnorm(m)\n  rt &lt;- rt + drift + diffusion\n  df[[length(df) + 1]] &lt;-\n    data.frame(id = 1:m, time=time[1 + i], rate=rt)\n}\ndf &lt;- do.call(rbind, df)\n\n# プロット\nggplot(df) +\n  geom_hline(yintercept = theta, linetype = \"dashed\") +\n  geom_line(aes(time, rate, group=id)) +\n  labs(\n    title = \"Discretized Vasicek Model\",\n    x = \"Time (t)\", y = \"Rate (t)\"\n  )\n\n\n\n\nVasicek モデルの離散シミュレーション（R）\n\n\n\n\n\n\n\nimport numpy as np\nimport pandas as pd\nfrom plotnine import *\ntheme_set(theme_bw())\n\nnp.random.seed(42)\n\nyears = 10\nN = 100 * years\ndt = years / N\ntime = np.linspace(0, years, N + 1)\n\nr0 = 0.01\nsigma = 0.02\ntheta = 0.05\nkappa = 0.5\nm = 25\n\n# オイラー・丸山法によるシミュレーション\nrt = np.repeat(r0, m)\ndf = list()\ndf.append(pd.DataFrame({'id':range(m), 'time':time[0], 'rate':rt}))\n\nfor i in range(N):\n  drift = kappa * (theta - rt) * dt\n  diffusion = sigma * np.sqrt(dt) * np.random.normal(0, 1, m)\n  rt = rt + drift + diffusion\n  df.append(\n    pd.DataFrame({'id':range(m), 'time':time[1+i], 'rate':rt})\n  )\ndf = pd.concat(df)\n\n# プロット\nggplot(df) + \\\n  geom_hline(yintercept=theta, linetype=\"dashed\") + \\\n  geom_line(aes(\"time\", \"rate\", group=\"id\")) + \\\n  labs(\n    subtitle = \"Discretized Vasicek Model\",\n    x = \"Time (t)\", y = \"Rate (t)\"\n  )\n\n\n\n\nVasicek モデルの離散シミュレーション（Python）\n\n\n\n\n\n\n\nVasicek モデルでは、時点 \\(t\\) における残存期間 \\(s\\) の利回り \\(\\delta(t, t+s)\\) を以下のように表すことができる。\n\\[\n\\begin{align}\n\\delta(t, t+s) &= \\frac{A(s) - B(s)\\;r_t}{s}\\\\\nB(s) &= \\frac{1 - e^{-\\kappa s}}{\\kappa}\\\\\nA(s) &= (\\theta^Q - \\frac{\\sigma^2}{2\\kappa^2})(B(s) - s) - \\frac{\\sigma^2}{4\\kappa}B(s)^2\n\\end{align}\n\\]\nここで、\\(\\theta^Q\\) はリスク調整後の（リスク中立的）長期平均金利であり、モデルから導出される債券価格と市場で観測される債券価格の誤差を最小化するなどの方法で推定される。ヒストリカル・データなどに基づいて推定される長期平均金利 \\(\\theta^P\\) にリスクプレミアムを加えたものと理解することもできる。\\(\\theta^P\\) と \\(\\theta^Q\\) のどちらも Vasicek モデルで使用されうるが、前者によるモデルは純粋な金利予測やリスク管理のために利用され、後者によるモデルは債券や金利デリバティブの時価評価に利用される。\n\\(\\theta^P\\) と \\(\\theta^Q\\) の関係を敷衍しておく。\\(dW_t^P\\) がウィーナー過程となる確率測度における Vasicek モデルは以下の式で表現される。\n\\[\ndr_t = \\kappa\\;(\\theta^P - r_t)\\;dt + \\sigma\\;dW_t^P\\\\\n\\]\nこのモデルを \\(dW_t^Q = dW_t^P + \\lambda dt\\) を用いて以下のように変換する。\n\\[\n\\begin{align}\ndr_t &= \\kappa (\\theta^P - r_t)\\ dt + \\sigma\\ (dW_t^Q - \\lambda dt)\\\\\n&= \\kappa\\;[(\\theta^P - \\frac{\\sigma\\lambda}{\\kappa}) - r_t]\\;dt + \\sigma dW_t^Q\n\\end{align}\n\\]\nこの式は、\\(dW_t^Q\\) がウィーナー過程となる確率測度における Vasicek モデルとなる。係数の比較により以下の関係が従う。\n\\[\n\\theta^Q = \\theta^P - \\frac{\\sigma\\lambda}{\\kappa}\n\\]\n一般に市場のリスク価格 \\(\\lambda\\) は負の値をとることが多く、その場合 \\(\\theta^Q &gt; \\theta^P\\) となる。これは、市場がリスクを考慮して現実の平均的な予測よりも高めの金利をイールドカーブに織り込むことに対応している。\n以下、Vasicek モデルにおける複数の瞬間金利水準に対応する イールドカーブの形状をプロットする。\n\nlibrary(ggplot2)\n\nkappa  &lt;- 0.5\ntheta &lt;- 0.06\nsigma  &lt;- 0.02\n\n# 解析解の関数定義\nvasicek_yield &lt;- function(rt, s, kappa, theta, sigma) {\n  B &lt;- (1 - exp(-kappa * s)) / kappa\n  A &lt;- (\n    (theta - sigma^2 / (2 * kappa^2)) * (B - s)\n    - (sigma^2 / (4 * kappa)) * B^2\n  )\n  yield &lt;- (B * rt - A) / s\n  return(yield)\n}\n\n# 3つの異なる瞬間金利でのカーブを比較\ntenors &lt;- seq(0.1, 30, by = 0.1)\nr0_samples &lt;- c(0.03, 0.06, 0.09)\n\ndf &lt;- list()\nfor(r0 in r0_samples){\n  y &lt;- vasicek_yield(r0, tenors, kappa, theta, sigma)\n  df[[length(df) + 1]] &lt;-\n    data.frame(tenor=tenors, yield=y, rt=as.factor(r0))\n}\ndf &lt;- do.call(rbind, df)\n\n# プロット\nggplot(df) +\n  geom_line(aes(x=tenor, y=yield, linetype=rt)) +\n  labs(title = \"Yield Curves in Vasicek Model\",\n       x = \"Time to Maturity\", y = \"Yield\",\n       lty = \"Current Rate\")\n\n\n\n\n特定の時点 t におけるイールドカーブ（解析解）\n\n\n\n\n金利のモデルとしての Vasicek モデルには以下のような課題がある。\n\n瞬間金利が負値となる可能性がある\nVasicek モデルでは、金利自身の誤差項にウィーナー過程／正規分布を仮定するため、金利 \\(r_t\\) がマイナスになりうる。\nイールドカーブの形状が限定される\nVasicek モデルにおけるイールドカーブの形状は理論上単純な形に限定されており、複雑な凹凸を持つことがある現実のイールドカーブを初期条件として表現できないことがある。\nボラティリティが一定である\n金利には、現在の金利水準が低いほどボラティリティも小さい傾向があるとされる。しかし、そのような性質は Vasicek モデルでは表現できない。",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Vasicekモデル</span>"
    ]
  },
  {
    "objectID": "src/hull-white.html",
    "href": "src/hull-white.html",
    "title": "Hull-Whiteモデル",
    "section": "",
    "text": "Hull-Whiteモデル（拡張Vasicekモデル）は、Vasicekモデルの平均回帰パラメータを時間依存させることにより、市場で観測される金利の期間構造に完全に適合できるように拡張された金利モデルである。市場価格と整合的な無裁定評価を行うための標準的なモデルの一つとして利用される。\nHull-White モデルは、瞬間金利 \\(r_t\\) を以下の確率微分方程式に従う確率過程で表現する。\n\\[\ndr_t = \\kappa\\; (\\theta(t) - r_t)\\; dt + \\sigma\\; dW_t\n\\]\nここで、\\(\\kappa\\) は平均回帰測度、\\(\\sigma\\) はボラティリティ、\\(\\theta(t)\\) は時間に依存する金利の平均回帰水準、\\(W_t\\) はウィーナー過程である。\nモデルが時点 \\(0\\) における市場のイールドカーブと整合するためには、\\(\\theta(t)\\) は以下のように決定される必要がある。\n\\[\n\\theta^Q(t) = f(0, t) + \\frac{1}{\\kappa} \\frac{\\partial f(0, t)}{\\partial t} + \\frac{\\sigma^2}{2\\kappa^2} (1 - e^{-2\\kappa t})\n\\]\nここで、\\(f(0, t)\\) は時点 \\(0\\) における満期 \\(t\\) の瞬間フォワード・レートであり、市場の割引債債価格 \\(v(0, t)\\) から以下のように定義される。\n\\[\nf(0, t) = - \\frac{\\partial \\ln v(0, t)}{\\partial t}\n\\]\n上記の \\(\\theta^Q(t)\\) はデリバティブや債券の市場価格から逆算されたものであり、リスク中立測度 \\(Q\\) に基づいている。一方、ヒストリカルデータ等から推定される現実的な平均回帰水準（\\(P\\)測度における\\(\\theta^P(t)\\)）とは市場のリスクプレミアム \\(\\lambda\\) だけ乖離する。\n\\[\n\\theta^Q(t) \\approx \\theta^P(t) - \\frac{\\sigma \\lambda}{\\kappa}\n\\]\n一般に、デリバティブ等の価格評価のためのモデルでは \\(\\theta^Q(t)\\) が用いられ、将来シミュレーションのためのモデルでは \\(\\theta^P(t)\\) が使用される。\n以下、見本路を構築してプロットするために、オイラー・丸山法を用いて Hull-White モデルの離散化を行う。時間刻みを \\(\\Delta t\\) とすると、以下のように定数項が時間変化する時変 AR(1) 過程として表現できる。\n\\[\n\\begin{align}\nr_{t+\\Delta t} &= r_t + \\kappa (\\theta(t) - r_t)\\;\\Delta t + \\sigma \\sqrt{\\Delta t}\\; \\epsilon_t\\\\\n&= \\kappa \\theta(t) \\Delta t + (1 - \\kappa \\Delta t)\\; r_t + \\sigma \\sqrt{\\Delta t}\\; \\epsilon_t\n\\end{align}\n\\]\n以下、離散化した Hull-White モデルの見本路を計算してプロットする。\n\nR\n\n\n\nlibrary(ggplot2)\ntheme_set(theme_bw())\n\nset.seed(42)\n\nyears &lt;- 10\nsteps &lt;- 100 * years\ndt &lt;- years / steps\ntime &lt;- seq(0, years, by = dt)\n\nr0 &lt;- 0.02\nkappa &lt;- 0.1\nsigma &lt;- 0.01\n\n# ダミーのイールドカーブ（f(0,t) = 0.02）に適合する平均回帰水準\ncalc_theta &lt;- function(t, kappa, sigma) {\n  f0t &lt;- 0.02\n  dfdt &lt;- 0\n  theta &lt;- (\n    f0t + (1/kappa) * dfdt\n    + (sigma^2 / (2 * kappa^2)) * (1 - exp(-2 * kappa * t))\n  )\n  return(theta)\n}\n\n# シミュレーション\nset.seed(42)\nsim_path &lt;- numeric(steps + 1)\nsim_path[1] &lt;- r0\n\ntime &lt;- seq(0, years, by = dt)\n\nfor (i in 1:steps) {\n  t &lt;- time[i]\n  rt &lt;- sim_path[i]\n  theta &lt;- calc_theta(t, kappa, sigma)\n  # 更新\n  dr &lt;- kappa * (theta - rt) * dt + sigma * sqrt(dt) * rnorm(1)\n  sim_path[i + 1] &lt;- rt + dr\n}\ndf &lt;- data.frame(time = time, rate = sim_path)\n\n# 可視化\nggplot(df, aes(x = time, y = rate)) +\n  geom_line() +\n  labs(title = \"Discretized Hull-White Model\",\n       x = \"Time\", y = \"Short Rate r(t)\")",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Hull-Whiteモデル</span>"
    ]
  }
]