---
title: "Hull-Whiteモデル"
---

Hull-Whiteモデル（拡張Vasicekモデル）は、Vasicekモデルの平均回帰パラメータを時間依存させることにより、市場で観測される金利の期間構造に完全に適合できるように拡張された金利モデルである。市場価格と整合的な無裁定評価を行うための標準的なモデルの一つとして利用される。

Hull-White モデルは、瞬間金利 $r_t$ を以下の確率微分方程式に従う確率過程で表現する。

$$
dr_t = \kappa\; (\theta(t) - r_t)\; dt + \sigma\; dW_t
$$

ここで、$\kappa$ は平均回帰測度、$\sigma$ はボラティリティ、$\theta(t)$ は時間に依存する金利の平均回帰水準、$W_t^Q$ はウィーナー過程である。

モデルが時点 $0$ における市場のイールドカーブと整合するためには、$\theta(t)$ は以下のように決定される必要がある。

$$
\theta^Q(t) = f(0, t) + \frac{1}{\kappa} \frac{\partial f(0, t)}{\partial t} + \frac{\sigma^2}{2\kappa^2} (1 - e^{-2\kappa t})
$$

ここで、$f(0, t)$ は時点 $0$ における満期 $t$ の瞬間フォワード・レートであり、市場の割引債債価格 $v(0, t)$ から以下のように定義される。

$$
f(0, t) = - \frac{\partial \ln v(0, t)}{\partial t}
$$

上記の $\theta^Q(t)$ はデリバティブや債券の市場価格から逆算されたものであり、リスク中立測度 $Q$ に基づいている。一方、ヒストリカルデータ等から推定される現実的な平均回帰水準（$P$測度における$\theta^P(t)$）とは市場のリスクプレミアム $\lambda$ だけ乖離する。

$$
\theta^Q(t) \approx \theta^P(t) - \frac{\sigma \lambda}{\kappa}
$$

一般に、デリバティブ等の価格評価のためのモデルでは $\theta^Q(t)$ が用いられ、将来シミュレーションのためのモデルでは $\theta^P(t)$ が使用される。

以下、見本路を構築してプロットするために、オイラー・丸山法を用いて Hull-White モデルの離散化を行う。時間刻みを $\Delta t$ とすると、以下のように定数項が時間変化する時変 AR(1) 過程として表現できる。

$$
\begin{align}
r_{t+\Delta t} &= r_t + \kappa (\theta(t) - r_t)\;\Delta t + \sigma \sqrt{\Delta t}\; \epsilon_t\\
&= \kappa \theta(t) \Delta t + (1 - \kappa \Delta t)\; r_t + \sigma \sqrt{\Delta t}\; \epsilon_t
\end{align}
$$

以下、離散化した Hull-White モデルの見本路を計算してプロットする。

::: panel-tabset
## R

```{r}
#| label: hw-simulation
#| message: false
#| warning: false
library(ggplot2)
theme_set(theme_bw())

set.seed(42)

years <- 10
steps <- 100 * years
dt <- years / steps
time <- seq(0, years, by = dt)

r0 <- 0.02
kappa <- 0.1
sigma <- 0.01

# ダミーのイールドカーブ（f(0,t) = 0.02）に適合する平均回帰水準
calc_theta <- function(t, kappa, sigma) {
  f0t <- 0.02
  dfdt <- 0
  theta <- (
    f0t + (1/kappa) * dfdt
    + (sigma^2 / (2 * kappa^2)) * (1 - exp(-2 * kappa * t))
  )
  return(theta)
}

# シミュレーション
set.seed(42)
sim_path <- numeric(steps + 1)
sim_path[1] <- r0

time <- seq(0, years, by = dt)

for (i in 1:steps) {
  t <- time[i]
  rt <- sim_path[i]
  theta <- calc_theta(t, kappa, sigma)
  # 更新
  dr <- kappa * (theta - rt) * dt + sigma * sqrt(dt) * rnorm(1)
  sim_path[i + 1] <- rt + dr
}
df <- data.frame(time = time, rate = sim_path)

# 可視化
ggplot(df, aes(x = time, y = rate)) +
  geom_line() +
  labs(title = "Discretized Hull-White Model",
       x = "Time", y = "Short Rate r(t)")
```

:::