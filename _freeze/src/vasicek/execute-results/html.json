{
  "hash": "74f4acd6ad09ecc999d81771cbb76ebb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Vasicekモデル\"\n---\n\nVasicek モデルは、金利が長期的にみれば一定の水準 $\\theta$ に引き戻されるという平均回帰性 (Mean Reversion) を取り入れた瞬間金利（Instantaneous Interest Rate）のモデルである。\n\n確率微分方程式は以下で与えられる。\n\n$$\ndr_t = \\kappa\\;(\\theta - r_t)\\;dt + \\sigma\\;dW_t\n$$\n\nただし、$\\kappa$ は長期平均金利への平均回帰速度、$\\theta$ は長期平均金利の水準、$\\sigma$ はボラティリティ、 $dW_t$ はウィーナー過程である。\n\nシミュレーションのために、オイラー・丸山法を用いて離散化すると以下のようになる。\n\n$$\nr_{t+\\Delta t} = r_t + \\kappa\\;(\\theta - r_t)\\;\\Delta t + \\sigma\\;\\sqrt{\\Delta t}\\;\\epsilon_t\n$$\n\nこれを以下のように整理すると、Vasicekモデルを離散化したものが1次の自己回帰モデル AR(1) に対応することがわかる。\n\n$$\nr_{t+\\Delta t} = \\kappa\\theta\\Delta t + (1 - \\kappa\\Delta t)\\;r_t + \\sigma\\;\\sqrt{\\Delta t}\\;\\epsilon_t\n$$\n\n以下は、初期金利を $r_0 = 1\\%$、ボラティリティを $\\sigma=2\\%$、長期平均金利を $\\theta=5\\%$、平均回帰速度を $\\kappa=0.5$ に設定した場合のシミュレーション例である。時間の経過とともに瞬間短期金利が $5\\%$ に近づいていく様子が確認できる。\n\n::: panel-tabset\n## R\n\n\n::: {.cell warnings='false'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\ntheme_set(theme_bw())\n\nset.seed(42)\n\nyears <- 10\nN <- 100 * years\ndt <- years / N\ntime <- seq(0, years, by = dt)\n\nr0 <- 0.01\nsigma <- 0.02\ntheta <- 0.05\nkappa <- 0.5\nm <- 25\n\n# オイラー・丸山法によるシミュレーション\nrt <- rep(r0, m)\ndf <- list()\ndf[[1]] <- data.frame(id = 1:m, time=time[1], rate=rt)\nfor (i in seq_len(N)) {\n  drift <- kappa * (theta - rt) * dt\n  diffusion <- sigma * sqrt(dt) * rnorm(m)\n  rt <- rt + drift + diffusion\n  df[[length(df) + 1]] <-\n    data.frame(id = 1:m, time=time[1 + i], rate=rt)\n}\ndf <- do.call(rbind, df)\n\n# プロット\nggplot(df) +\n  geom_hline(yintercept = theta, linetype = \"dashed\") +\n  geom_line(aes(time, rate, group=id)) +\n  labs(\n    title = \"Discretized Vasicek Model\",\n    x = \"Time (t)\", y = \"Rate (t)\"\n  )\n```\n\n::: {.cell-output-display}\n![Vasicek モデルの離散シミュレーション（R）](vasicek_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n## Python\n\n\n::: {.cell warnings='false'}\n\n```{.python .cell-code}\nimport numpy as np\nimport pandas as pd\nfrom plotnine import *\ntheme_set(theme_bw())\n\nnp.random.seed(42)\n\nyears = 10\nN = 100 * years\ndt = years / N\ntime = np.linspace(0, years, N + 1)\n\nr0 = 0.01\nsigma = 0.02\ntheta = 0.05\nkappa = 0.5\nm = 25\n\n# オイラー・丸山法によるシミュレーション\nrt = np.repeat(r0, m)\ndf = list()\ndf.append(pd.DataFrame({'id':range(m), 'time':time[0], 'rate':rt}))\n\nfor i in range(N):\n  drift = kappa * (theta - rt) * dt\n  diffusion = sigma * np.sqrt(dt) * np.random.normal(0, 1, m)\n  rt = rt + drift + diffusion\n  df.append(\n    pd.DataFrame({'id':range(m), 'time':time[1+i], 'rate':rt})\n  )\ndf = pd.concat(df)\n\n# プロット\nggplot(df) + \\\n  geom_hline(yintercept=theta, linetype=\"dashed\") + \\\n  geom_line(aes(\"time\", \"rate\", group=\"id\")) + \\\n  labs(\n    subtitle = \"Discretized Vasicek Model\",\n    x = \"Time (t)\", y = \"Rate (t)\"\n  )\n```\n\n\n::: {.cell-output-display}\n![Vasicek モデルの離散シミュレーション（Python）](vasicek_files/figure-html/unnamed-chunk-2-1.png){width=614}\n:::\n:::\n\n:::\n\nVasicek モデルにおいて、時点 $t$ における残存期間 $s$ の利回り $R(t, t+s)$ は以下の式で与えられる。\n\n$$\n\\begin{align}\nR(t, t+s) &= \\frac{A(s) - B(s)\\;r_t}{s}\\\\\nB(s) &= \\frac{1 - e^{-\\kappa s}}{\\kappa}\\\\\nA(s) &= (\\theta^* - \\frac{\\sigma^2}{2\\kappa^2})(B(s) - s) - \\frac{\\sigma^2}{4\\kappa}B(s)^2\n\\end{align}\n$$\n\nここで、$\\theta^*$ は リスク中立的な長期平均金利 と呼ばれる。これは現実の平均金利 $\\theta$ に、投資家がリスクに対して要求する上乗せ報酬（リスクプレミアム）を加味したものである。\n\n$$\n\\theta^* = \\theta - \\frac{\\sigma\\lambda}{\\kappa}\n$$\n\n一般に市場のリスク価格 $\\lambda$ は負の値をとることが多く、その場合 $\\theta^* > \\theta$ となる。これは、市場が「現実の平均的な予測」よりも、リスクを考慮して「高めの金利」をイールドカーブに織り込むことを意味する。\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nkappa  <- 0.5\ntheta_star <- 0.06\nsigma  <- 0.02\n\n# 解析解の関数定義\nvasicek_yield <- function(rt, x, kappa, theta_star, sigma) {\n  B <- (1 - exp(-kappa * x)) / kappa\n  A <- (theta_star - sigma^2 / (2 * kappa^2)) * (B - x) - (sigma^2 / (4 * kappa)) * B^2\n  yield <- (B * rt - A) / x\n  return(yield)\n}\n\n# 3つの異なる瞬間金利でのカーブを比較\ntenors <- seq(0.1, 30, by = 0.1)\nr0_samples <- c(0.03, 0.06, 0.09)\n\ndf <- list()\nfor(r0 in r0_samples){\n  y <- vasicek_yield(r0, tenors, kappa, theta_star, sigma)\n  df[[length(df) + 1]] <-\n    data.frame(tenor=tenors, yield=y, r_start=as.factor(r0))\n}\ndf <- do.call(rbind, df)\n\n# プロット\nggplot(df) +\n  geom_line(aes(x=tenor, y=yield, linetype=r_start)) +\n  labs(title = \"Yield Curves in Vasicek Model\",\n       x = \"Time to Maturity (Years)\", y = \"Yield\",\n       lty = \"Current Rate (r_t)\")\n```\n\n::: {.cell-output-display}\n![特定の時点 t におけるイールドカーブ（解析解）](vasicek_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n:::\n\n\n\n金利のモデルとしての Vasicek モデルには以下のような課題がある。\n\n1.  瞬間金利が負値となる可能性がある\n\nVasicek モデルでは、金利自身の誤差項にウィーナー過程／正規分布を仮定するため、金利 $r_t$ がマイナスになることが許容される。\n\n2.  イールドカーブの形状が限定される\n\nVasicek モデルにおけるイールドカーブの形状は理論上単純な形に限定されており、複雑な凹凸を持つことがある現実のイールドカーブを初期条件として表現できないことがある。\n\n3.  ボラティリティが一定である\n\n金利には、現在の金利水準が低いほどボラティリティも小さい傾向があるとされる。しかし、そのような性質は Vasicek モデルでは表現できない。\n",
    "supporting": [
      "vasicek_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}